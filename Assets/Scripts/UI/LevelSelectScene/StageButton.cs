using System.Collections;
using System.Collections.Generic;
using UnityEngine;
using UnityEngine.SceneManagement;
using System.IO;


// json파일로 저장하기 위해 만든 class
// 선택한 스테이지 버튼에 따라 phase와 stage가 저장된다.
[System.Serializable]
public class PhaseStage
{
    public int phase;
    public int stage;
}

public class StageButton : MonoBehaviour
{
    private PhaseStage selectPhaseStage = new PhaseStage();

    void Start()
    {

    }

    void Update()
    {
        
    }

    // phaseStage를 json으로 저장하는 함수
    private void SavePhaseStageToJson()
	{
        string jsonData = JsonUtility.ToJson(selectPhaseStage, true);
        string path = Path.Combine(Application.dataPath + "/Resources/Data/", "selectPhaseStage.json");
        File.WriteAllText(path, jsonData);
	}

    // stage 버튼에 연결되는 OnClick 함수
    public void stageButtonClick(string level)
	{
        selectPhaseStage.phase = level[0] - '0';
        selectPhaseStage.stage = level[1] - '0';

        SavePhaseStageToJson();
        LoadCharacterSelectScene();
    }

    private void LoadCharacterSelectScene()
	{
        if(selectPhaseStage.phase == 3 && selectPhaseStage.stage == 5)
		{
            GameManager.GetInstance.MoveScene("LevelSelectScene", "BossWave");
		}
        
        GameManager.GetInstance.MoveScene("LevelSelectScene", "CharacterSelectScene");
    }
}
